<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <style type="text/css">

#watermark {

  position: relative;
  overflow: hidden;
}

#watermark .x {
  position: absolute;
  top: 800;
  left: 400;
  color: #3300ff;
  font-size: 50px;
  pointer-events: none;
  opacity:0.3;
  filter:Alpha(opacity=50);
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
}
    </style>


    <style type="text/css">
 html{color:#333;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%;text-rendering:optimizelegibility;font-family:Helvetica Neue,PingFang SC,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif}html.borderbox *,html.borderbox :after,html.borderbox :before{box-sizing:border-box}article,aside,blockquote,body,button,code,dd,details,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hr,input,legend,li,menu,nav,ol,p,pre,section,td,textarea,th,ul{margin:0;padding:0}article,aside,details,figcaption,figure,footer,header,menu,nav,section{display:block}audio,canvas,video{display:inline-block}body,button,input,select,textarea{font:300 1em/1.8 PingFang SC,Lantinghei SC,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,Helvetica,sans-serif}button::-moz-focus-inner,input::-moz-focus-inner{padding:0;border:0}table{border-collapse:collapse;border-spacing:0}fieldset,img{border:0}blockquote{position:relative;color:#999;font-weight:400;border-left:1px solid #1abc9c;padding-left:1em;margin:1em 3em 1em 2em}@media only screen and (max-width:640px){blockquote{margin:1em 0}}abbr,acronym{border-bottom:1px dotted;font-variant:normal}abbr{cursor:help}del{text-decoration:line-through}address,caption,cite,code,dfn,em,th,var{font-style:normal;font-weight:400}ol,ul{list-style:none}caption,th{text-align:left}q:after,q:before{content:""}sub,sup{font-size:75%;line-height:0;position:relative}:root sub,:root sup{vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}a{color:#1abc9c}a:hover{text-decoration:underline}.typo a{border-bottom:1px solid #1abc9c}.typo a:hover{border-bottom-color:#555;color:#555}.typo a:hover,a,ins{text-decoration:none}.typo-u,u{text-decoration:underline}mark{background:#fffdd1;border-bottom:1px solid #ffedce;padding:2px;margin:0 5px}code,pre,pre tt{font-family:Courier,Courier New,monospace}pre{background:hsla(0,0%,97%,.7);border:1px solid #ddd;padding:1em 1.5em;display:block;-webkit-overflow-scrolling:touch}hr{border:none;border-bottom:1px solid #cfcfcf;margin-bottom:.8em;height:10px}.typo-small,figcaption,small{font-size:.9em;color:#888}b,strong{font-weight:700;color:#000}[draggable]{cursor:move}.clearfix:after,.clearfix:before{content:"";display:table}.clearfix:after{clear:both}.clearfix{zoom:1}.textwrap,.textwrap td,.textwrap th{word-wrap:break-word;word-break:break-all}.textwrap-table{table-layout:fixed}.serif{font-family:Palatino,Optima,Georgia,serif}.typo-dl,.typo-form,.typo-hr,.typo-ol,.typo-p,.typo-pre,.typo-table,.typo-ul,.typo dl,.typo form,.typo hr,.typo ol,.typo p,.typo pre,.typo table,.typo ul,blockquote{margin-bottom:1rem}h1,h2,h3,h4,h5,h6{font-family:PingFang SC,Helvetica Neue,Verdana,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;line-height:1.35}.typo-h1,.typo-h2,.typo-h3,.typo-h4,.typo-h5,.typo-h6,.typo h1,.typo h2,.typo h3,.typo h4,.typo h5,.typo h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}.typo-h1,.typo h1{font-size:2em}.typo-h2,.typo h2{font-size:1.8em}.typo-h3,.typo h3{font-size:1.6em}.typo-h4,.typo h4{font-size:1.4em}.typo-h5,.typo-h6,.typo h5,.typo h6{font-size:1.2em}.typo-ul,.typo ul{margin-left:1.3em;list-style:disc}.typo-ol,.typo ol{list-style:decimal;margin-left:1.9em}.typo-ol ol,.typo-ol ul,.typo-ul ol,.typo-ul ul,.typo li ol,.typo li ul{margin-bottom:.8em;margin-left:2em}.typo-ol ul,.typo-ul ul,.typo li ul{list-style:circle}.typo-table td,.typo-table th,.typo table caption,.typo table td,.typo table th{border:1px solid #ddd;padding:.5em 1em;color:#666}.typo-table th,.typo table th{background:#fbfbfb}.typo-table thead th,.typo table thead th{background:hsla(0,0%,95%,.7)}.typo table caption{border-bottom:none}.typo-input,.typo-textarea{-webkit-appearance:none;border-radius:0}.typo-em,.typo em,caption,legend{color:#000;font-weight:inherit}.typo-em{position:relative}.typo-em:after{position:absolute;top:.65em;left:0;width:100%;overflow:hidden;white-space:nowrap;content:"\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB\30FB"}.typo img{max-width:100%}.common-content{font-weight:400;color:#353535;line-height:1.75rem;white-space:normal;word-break:normal;font-size:1rem}.common-content img{display:block;max-width:100%;background-color:#eee}.common-content audio,.common-content video{width:100%;background-color:#eee}.common-content center,.common-content font{margin-top:1rem;display:inline-block}.common-content center{width:100%}.common-content pre{margin-top:1rem;padding-left:0;padding-right:0;position:relative;overflow:hidden}.common-content pre code{font-size:.8rem;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;width:100%;box-sizing:border-box;padding-left:1rem;padding-right:1rem;overflow-x:auto}.common-content hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}.common-content b,.common-content h1,.common-content h2,.common-content h3,.common-content h4,.common-content h5,.common-content strong{font-weight:700}.common-content h1,.common-content h2{font-size:1.125rem;margin-bottom:.45rem}.common-content h3,.common-content h4,.common-content h5{font-size:1rem;margin-bottom:.45rem}.common-content p{font-weight:400;color:#353535;margin-top:.15rem}.common-content .orange{color:#ff5a05}.common-content .reference{font-size:1rem;color:#888}.custom-rich-content h1{margin-top:0;font-weight:400;font-size:15.25px;border-bottom:1px solid #eee;line-height:2.8}.custom-rich-content li,.custom-rich-content p{font-size:14px;color:#888;line-height:1.6}table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}table.hljs-ln,table.hljs-ln tbody,table.hljs-ln td,table.hljs-ln tr{box-sizing:border-box}table.hljs-ln td{padding:0;border:0}table.hljs-ln td.hljs-ln-numbers{min-width:15px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}table.hljs-ln td.hljs-ln-code,table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px;line-height:20px;vertical-align:top}table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;color:#24292e;word-wrap:normal;white-space:pre}video::-webkit-media-controls{overflow:hidden!important}video::-webkit-media-controls-enclosure{width:calc(100% + 32px);margin-left:auto}.button-cancel{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel,.button-primary{-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary{color:#fff;background-color:#ff5a05;border-radius:3px}@font-face{font-family:iconfont;src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot);src:url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.woff) format("woff"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.ttf) format("truetype"),url(//at.alicdn.com/t/font_372689_bwwwtosxtzp.svg#iconfont) format("svg")}@font-face{font-family:player-font;src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot);src:url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.eot#iefix) format("embedded-opentype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.woff) format("woff"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.ttf) format("truetype"),url(//at.alicdn.com/t/font_509397_1cyjv4o90qiod2t9.svg#player-font) format("svg")}.iconfont{font-family:iconfont!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-webkit-text-stroke-width:.2px;-moz-osx-font-smoothing:grayscale}html{background:#fff;min-height:100%;-webkit-tap-highlight-color:rgba(0,0,0,0)}body{width:100%}body.fixed{overflow:hidden;position:fixed;width:100vw;height:100vh}i{font-style:normal}a{word-wrap:break-word;-webkit-tap-highlight-color:rgba(0,0,0,0)}a:hover{text-decoration:none}.fade-enter-active,.fade-leave-active{transition:opacity .3s}.fade-enter,.fade-leave-to{opacity:0}.MathJax,.MathJax_CHTML,.MathJax_MathContainer,.MathJax_MathML,.MathJax_PHTML,.MathJax_PlainSource,.MathJax_SVG{outline:0}.ios-app-switch .js-audit{display:none}._loading_wrap_{position:fixed;width:100vw;height:100vh;top:50%;left:50%;transform:translate(-50%,-50%);z-index:999}._loading_div_class_,._loading_wrap_{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}._loading_div_class_{word-wrap:break-word;padding:.5rem .75rem;text-align:center;z-index:9999;font-size:.6rem;max-width:60%;color:#fff;border-radius:.25rem;-ms-flex-direction:column;flex-direction:column}._loading_div_class_ .message{color:#353535;font-size:16px;line-height:3}.spinner{animation:circle-rotator 1.4s linear infinite}.spinner *{line-height:0;box-sizing:border-box}@keyframes circle-rotator{0%{transform:rotate(0deg)}to{transform:rotate(270deg)}}.path{stroke-dasharray:187;stroke-dashoffset:0;transform-origin:center;animation:circle-dash 1.4s ease-in-out infinite,circle-colors 5.6s ease-in-out infinite}@keyframes circle-colors{0%{stroke:#ff5a05}to{stroke:#ff5a05}}@keyframes circle-dash{0%{stroke-dashoffset:187}50%{stroke-dashoffset:46.75;transform:rotate(135deg)}to{stroke-dashoffset:187;transform:rotate(450deg)}}.confirm-box-wrapper,.confirm-box-wrapper .mask{position:absolute;top:0;left:0;right:0;bottom:0}.confirm-box-wrapper .mask{background:rgba(0,0,0,.6)}.confirm-box-wrapper .confirm-box{position:fixed;top:50%;left:50%;width:267px;background:#fff;transform:translate(-50%,-50%);border-radius:7px}.confirm-box-wrapper .confirm-box .head{margin:0 18px;font-size:18px;text-align:center;line-height:65px;border-bottom:1px solid #d9d9d9}.confirm-box-wrapper .confirm-box .body{padding:18px;padding-bottom:0;color:#353535;font-size:12.5px;max-height:150px;overflow:auto}.confirm-box-wrapper .confirm-box .foot{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;padding:18px}.confirm-box-wrapper .confirm-box .foot .button-cancel{border:1px solid #d9d9d9}.hljs{display:block;overflow-x:auto;padding:.5em;color:#333;background:#f8f8f8}.hljs-comment,.hljs-quote{color:#998;font-style:italic}.hljs-keyword,.hljs-selector-tag,.hljs-subst{color:#333;font-weight:700}.hljs-literal,.hljs-number,.hljs-tag .hljs-attr,.hljs-template-variable,.hljs-variable{color:teal}.hljs-doctag,.hljs-string{color:#d14}.hljs-section,.hljs-selector-id,.hljs-title{color:#900;font-weight:700}.hljs-subst{font-weight:400}.hljs-class .hljs-title,.hljs-type{color:#458;font-weight:700}.hljs-attribute,.hljs-name,.hljs-tag{color:navy;font-weight:400}.hljs-link,.hljs-regexp{color:#009926}.hljs-bullet,.hljs-symbol{color:#990073}.hljs-built_in,.hljs-builtin-name{color:#0086b3}.hljs-meta{color:#999;font-weight:700}.hljs-deletion{background:#fdd}.hljs-addition{background:#dfd}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}




    </style>
    <style type="text/css">
        .button-cancel[data-v-87ffcada]{color:#888;border:1px solid #888;border-radius:3px;margin-right:12px}.button-cancel[data-v-87ffcada],.button-primary[data-v-87ffcada]{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}.button-primary[data-v-87ffcada]{color:#fff;background-color:#ff5a05;border-radius:3px}.pd[data-v-87ffcada]{padding-left:1.375rem;padding-right:1.375rem}.article[data-v-87ffcada]{max-width:70rem;margin:0 auto}.article .article-unavailable[data-v-87ffcada]{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}.article .article-unavailable .iconfont[data-v-87ffcada]{font-size:12px}.article .main[data-v-87ffcada]{padding:1.25rem 0;margin-bottom:52px}.article-title[data-v-87ffcada]{color:#353535;font-weight:400;line-height:1.65rem;font-size:1.34375rem}.article-info[data-v-87ffcada]{color:#888;font-size:.9375rem;margin-top:1.0625rem}.article-content[data-v-87ffcada]{margin-top:1.0625rem}.article-content.android video[data-v-87ffcada]::-webkit-media-controls-fullscreen-button{display:none}.copyright[data-v-87ffcada]{color:#b2b2b2;padding-bottom:20px;margin-top:20px;font-size:13px}.audio-player[data-v-87ffcada]{width:100%;margin:20px 0}.to-comment[data-v-87ffcada]{overflow:hidden;padding-top:10px;margin-bottom:-30px}.to-comment a.button-primary[data-v-87ffcada]{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}.article-comments[data-v-87ffcada]{margin-top:2rem}.article-comments h2[data-v-87ffcada]{text-align:center;color:#888;position:relative;z-index:1;margin-bottom:1rem}.article-comments h2[data-v-87ffcada]:before{border-top:1px dotted #888;content:"";position:absolute;top:56%;left:0;width:100%;z-index:-1}.article-comments h2 span[data-v-87ffcada]{font-size:15.25px;font-weight:400;padding:0 1rem;background:#fff;display:inline-block}.article-sub-bottom[data-v-87ffcada]{z-index:10;cursor:pointer}.switch-btns[data-v-87ffcada]{height:76px;cursor:pointer;padding-top:24px;padding-bottom:24px;border-bottom:10px solid #f6f7fb;position:relative}.switch-btns[data-v-87ffcada]:before{content:" ";height:1px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:1.375rem;right:1.375rem}.switch-btns .btn[data-v-87ffcada]{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.switch-btns .btn .tag[data-v-87ffcada]{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}.switch-btns .btn .txt[data-v-87ffcada]{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}@media (max-width:769px){.article .breadcrumb[data-v-87ffcada]{padding-top:10px;padding-bottom:10px}}





    </style>

    <style type="text/css">
        .comment-item{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:1rem}.comment-item a{border-bottom:none}.comment-item .avatar{width:2.625rem;height:2.625rem;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.comment-item .info{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.comment-item .info .hd{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .username{color:#888;font-size:15.25px;font-weight:400;line-height:1.2}.comment-item .info .hd .control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.comment-item .info .hd .control .btn-share{color:#888;font-size:.75rem;margin-right:1rem}.comment-item .info .hd .control .btn-praise{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.comment-item .info .hd .control .btn-praise i{color:#888;display:inline-block;font-size:.75rem;margin-right:.3rem;margin-top:-.01rem}.comment-item .info .hd .control .btn-praise i.on,.comment-item .info .hd .control .btn-praise span{color:#ff5a05}.comment-item .info .bd{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all;line-height:1.6}.comment-item .info .time{color:#888;font-size:9px;line-height:1}.comment-item .info .reply .reply-hd{font-size:15.25px}.comment-item .info .reply .reply-hd span{margin-left:-12px;color:#888;font-weight:400}.comment-item .info .reply .reply-hd i{color:#ff5a05;font-size:15.25px}.comment-item .info .reply .reply-content{color:#353535;font-size:15.25px;font-weight:400;white-space:normal;word-break:break-all}.comment-item .info .reply .reply-time{color:#888;font-size:9px}




    </style>
</head>
<body>
<div id="app">


    <div data-v-87ffcada="" class="article" id="watermark">
        <p class="x">æ›´å¤šè¯¾ç¨‹è¯·åŠ QQ1046877154ï¼Œå¾®ä¿¡loveu_110è·å–</p>
        <div data-v-87ffcada="" class="main main-app">
            <h1 data-v-87ffcada="" class="article-title pd">
                05è®²å¡é¡¿ä¼˜åŒ–ï¼ˆä¸Šï¼‰ï¼šä½ è¦æŒæ¡çš„å¡é¡¿åˆ†ææ–¹æ³•
            </h1>
            <div data-v-87ffcada="" class="article-content typo common-content pd"><img data-v-87ffcada=""
                                                                                        src="https://static001.geekbang.org/resource/image/a5/40/a516ba2a3aedeed995aab83580f27c40.jpg">


                <div data-v-87ffcada="" id="article-content" class="">
                    <div class="text">
                        <p>â€œæˆ‘çš„åç¾¿æ€ä¹ˆåŠ¨ä¸äº†ï¼â€ï¼Œåœ¨ç©ã€Šç‹è€…è£è€€ã€‹çš„æ—¶å€™æœ€æ€•é‡åˆ°å›¢æˆ˜æ—¶å¡å¾—è·Ÿå¹»ç¯ç‰‡ä¸€æ ·ã€‚å¯¹äºåº”ç”¨ä¹Ÿæ˜¯è¿™æ ·ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå¬åˆ°ç”¨æˆ·æŠ±æ€¨ï¼šâ€œè¿™ä¸ªåº”ç”¨å¯åŠ¨æ€ä¹ˆé‚£ä¹ˆæ…¢ï¼Ÿâ€â€œæ»‘åŠ¨çš„æ—¶å€™æ€ä¹ˆé‚£ä¹ˆå¡ï¼Ÿâ€ã€‚</p><p>å¯¹ç”¨æˆ·æ¥è¯´ï¼Œå†…å­˜å ç”¨é«˜ã€è€—è´¹ç”µé‡ã€è€—è´¹æµé‡å¯èƒ½ä¸å®¹æ˜“è¢«å‘ç°ï¼Œä½†æ˜¯ç”¨æˆ·å¯¹å¡é¡¿ç‰¹åˆ«æ•æ„Ÿï¼Œå¾ˆå®¹æ˜“ç›´è§‚æ„Ÿå—åˆ°ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œå¡é¡¿é—®é¢˜åˆéå¸¸éš¾ä»¥æ’æŸ¥å®šä½ï¼Œäº§ç”Ÿçš„åŸå› é”™ç»¼å¤æ‚ï¼Œè·ŸCPUã€å†…å­˜ã€ç£ç›˜I/Oéƒ½å¯èƒ½æœ‰å…³ï¼Œè·Ÿç”¨æˆ·å½“æ—¶çš„ç³»ç»Ÿç¯å¢ƒä¹Ÿæœ‰å¾ˆå¤§å…³ç³»ã€‚</p><p>é‚£åˆ°åº•è¯¥å¦‚ä½•å®šä¹‰å¡é¡¿å‘¢ï¼Ÿåœ¨æœ¬åœ°æœ‰å“ªäº›å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°å‘ç°å’Œæ’æŸ¥é—®é¢˜å‘¢ï¼Ÿè¿™äº›å·¥å…·ä¹‹é—´çš„å·®å¼‚åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä»Šå¤©æˆ‘æ¥å¸®ä½ è§£å†³è¿™äº›å›°æƒ‘ã€‚</p><h2>åŸºç¡€çŸ¥è¯†</h2><p>åœ¨å…·ä½“è®²å¡é¡¿å·¥å…·å‰ï¼Œä½ éœ€è¦äº†è§£ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œå®ƒä»¬ä¸»è¦éƒ½å’ŒCPUç›¸å…³ã€‚é€ æˆå¡é¡¿çš„åŸå› å¯èƒ½æœ‰åƒç™¾ç§ï¼Œä¸è¿‡æœ€ç»ˆéƒ½ä¼šåæ˜ åˆ°<strong>CPUæ—¶é—´</strong>ä¸Šã€‚æˆ‘ä»¬å¯ä»¥æŠŠCPUæ—¶é—´åˆ†ä¸ºä¸¤ç§ï¼šç”¨æˆ·æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´ã€‚ç”¨æˆ·æ—¶é—´å°±æ˜¯æ‰§è¡Œç”¨æˆ·æ€åº”ç”¨ç¨‹åºä»£ç æ‰€æ¶ˆè€—çš„æ—¶é—´ï¼›ç³»ç»Ÿæ—¶é—´å°±æ˜¯æ‰§è¡Œå†…æ ¸æ€ç³»ç»Ÿè°ƒç”¨æ‰€æ¶ˆè€—çš„æ—¶é—´ï¼ŒåŒ…æ‹¬I/Oã€é”ã€ä¸­æ–­ä»¥åŠå…¶ä»–ç³»ç»Ÿè°ƒç”¨çš„æ—¶é—´ã€‚</p><p><strong>1. CPUæ€§èƒ½</strong></p><p>æˆ‘ä»¬å…ˆæ¥ç®€å•è®²è®²CPUçš„æ€§èƒ½ï¼Œè€ƒè™‘åˆ°åŠŸè€—ã€ä½“ç§¯è¿™äº›å› ç´ ï¼Œç§»åŠ¨è®¾å¤‡å’ŒPCçš„CPUä¼šæœ‰ä¸å°‘çš„å·®å¼‚ã€‚ä½†è¿‘å¹´æ¥ï¼Œæ‰‹æœºCPUçš„æ€§èƒ½ä¹Ÿåœ¨å‘PCå¿«é€Ÿé æ‹¢ï¼Œåä¸ºMate 20çš„â€œéº’éºŸ980â€å’ŒiPhone XSçš„â€œA12â€å·²ç»ç‡å…ˆä½¿ç”¨é¢†å…ˆPCçš„7çº³ç±³å·¥è‰ºã€‚</p><!-- [[[read_end]]] --><p>è¯„ä»·ä¸€ä¸ªCPUçš„æ€§èƒ½ï¼Œéœ€è¦çœ‹ä¸»é¢‘ã€æ ¸å¿ƒæ•°ã€ç¼“å­˜ç­‰å‚æ•°ï¼Œå…·ä½“è¡¨ç°å‡ºæ¥çš„æ˜¯è®¡ç®—èƒ½åŠ›å’ŒæŒ‡ä»¤æ‰§è¡Œèƒ½åŠ›ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’æ‰§è¡Œçš„æµ®ç‚¹è®¡ç®—æ•°å’Œæ¯ç§’æ‰§è¡Œçš„æŒ‡ä»¤æ•°ã€‚</p><p>å½“ç„¶è¿˜è¦è€ƒè™‘åˆ°æ¶æ„é—®é¢˜ï¼Œ â€œéº’éºŸ980â€é‡‡ç”¨ä¸‰çº§èƒ½æ•ˆæ¶æ„ï¼Œ2ä¸ª2.6GHzä¸»é¢‘çš„A76è¶…å¤§æ ¸ + 2ä¸ª1.92GHzä¸»é¢‘çš„A76å¤§æ ¸ + 4ä¸ª1.8GHzä¸»é¢‘çš„A55å°æ ¸ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œâ€œA12â€ä½¿ç”¨2ä¸ªæ€§èƒ½æ ¸å¿ƒ + 4ä¸ªèƒ½æ•ˆæ ¸å¿ƒçš„æ¶æ„ï¼Œè¿™æ ·è®¾è®¡ä¸»è¦æ˜¯ä¸ºäº†åœ¨æ—¥å¸¸ä½è´Ÿè·å·¥ä½œæ—¶ï¼Œä½¿ç”¨ä½é¢‘æ ¸å¿ƒæ›´åŠ èŠ‚çœç”µé‡ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è·å¾—è®¾å¤‡çš„CPUä¿¡æ¯ã€‚</p><pre><code>// è·å– CPU æ ¸å¿ƒæ•°
cat /sys/devices/system/cpu/possible  

// è·å–æŸä¸ª CPU çš„é¢‘ç‡
cat /sys/devices/system/cpu/cpu0/cpufreq/cpuinfo_max_freq
</code></pre><p>éšç€æœºå™¨å­¦ä¹ çš„å…´èµ·ï¼Œç°ä»£èŠ¯ç‰‡ä¸ä»…å¸¦æœ‰å¼ºå¤§çš„GPUï¼Œè¿˜é…å¤‡äº†ä¸“é—¨ä¸ºç¥ç»ç½‘ç»œè®¡ç®—æ‰“é€ çš„NPUï¼ˆNeural network Processing Unitï¼‰ã€‚â€œA12â€å°±ä½¿ç”¨äº†å…«æ ¸å¿ƒçš„NPUï¼Œæ¯ç§’å¯æ‰§è¡Œäº”ä¸‡äº¿æ¬¡è¿ç®—ã€‚<strong>ä»CPUåˆ°GPUå†åˆ°AIèŠ¯ç‰‡ï¼Œéšç€æ‰‹æœºCPU æ•´ä½“æ€§èƒ½çš„é£è·ƒï¼ŒåŒ»ç–—è¯Šæ–­ã€å›¾åƒè¶…æ¸…åŒ–ç­‰ä¸€äº›AIåº”ç”¨åœºæ™¯ä¹Ÿå¯ä»¥åœ¨ç§»åŠ¨ç«¯æ›´å¥½åœ°è½åœ°ã€‚æœ€è¿‘è¾¹ç¼˜è®¡ç®—ä¹Ÿè¶Šæ¥è¶Šå¤šçš„è¢«æåŠï¼Œæˆ‘ä»¬å¸Œæœ›å¯ä»¥æ›´å¤§ç¨‹åº¦åœ°åˆ©ç”¨ç§»åŠ¨ç«¯çš„è®¡ç®—èƒ½åŠ›æ¥é™ä½é«˜æ˜‚çš„æœåŠ¡å™¨æˆæœ¬ã€‚</strong></p><p>ä¹Ÿå› æ­¤åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è®¾å¤‡CPUæ€§èƒ½æ¥â€œçœ‹èœä¸‹é¥­â€ï¼Œä¾‹å¦‚çº¿ç¨‹æ± ä½¿ç”¨çº¿ç¨‹æ•°æ ¹æ®CPUçš„æ ¸å¿ƒæ•°ï¼Œä¸€äº›é«˜çº§çš„AIåŠŸèƒ½åªåœ¨ä¸»é¢‘æ¯”è¾ƒé«˜æˆ–è€…å¸¦æœ‰NPUçš„è®¾å¤‡å¼€å¯ã€‚</p><p>æ‹“å±•äº†é‚£ä¹ˆå¤šå†å›åˆ°å‰é¢æˆ‘è®²çš„CPUæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´ã€‚å½“å‡ºç°å¡é¡¿é—®é¢˜çš„æ—¶å€™ï¼Œåº”è¯¥æ€ä¹ˆå»åŒºåˆ†ç©¶ç«Ÿæ˜¯æˆ‘ä»¬ä»£ç çš„é—®é¢˜ï¼Œè¿˜æ˜¯ç³»ç»Ÿçš„é—®é¢˜ï¼Ÿç”¨æˆ·æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´å¯ä»¥ç»™æˆ‘ä»¬å“ªäº›çº¿ç´¢ï¼Ÿè¿™é‡Œè¿˜è¦é›†åˆä¸¤ä¸ªéå¸¸é‡è¦çš„æŒ‡æ ‡ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬åšåˆ¤æ–­ã€‚</p><p><strong>2. å¡é¡¿é—®é¢˜åˆ†ææŒ‡æ ‡</strong></p><p>å‡ºç°å¡é¡¿é—®é¢˜åï¼Œé¦–å…ˆæˆ‘ä»¬åº”è¯¥æŸ¥çœ‹<strong>CPUçš„ä½¿ç”¨ç‡</strong>ã€‚æ€ä¹ˆæŸ¥å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>/proc/stat</code>å¾—åˆ°æ•´ä¸ªç³»ç»Ÿçš„CPUä½¿ç”¨æƒ…å†µï¼Œé€šè¿‡<code>/proc/[pid]/stat</code>å¯ä»¥å¾—åˆ°æŸä¸ªè¿›ç¨‹çš„CPUä½¿ç”¨æƒ…å†µã€‚</p><p>å…³äºstatæ–‡ä»¶å„ä¸ªå±æ€§çš„å«ä¹‰å’ŒCPUä½¿ç”¨ç‡çš„è®¡ç®—ï¼Œä½ å¯ä»¥é˜…è¯»<a href="http://www.samirchen.com/linux-cpu-performance/">ã€ŠLinuxç¯å¢ƒä¸‹è¿›ç¨‹çš„CPUå ç”¨ç‡ã€‹</a>å’Œ<a href="http://man7.org/linux/man-pages/man5/proc.5.html">Linuxæ–‡æ¡£</a>ã€‚å…¶ä¸­æ¯”è¾ƒé‡è¦çš„å­—æ®µæœ‰ï¼š</p><pre><code>proc/self/stat:
  utime:       ç”¨æˆ·æ—¶é—´ï¼Œååº”ç”¨æˆ·ä»£ç æ‰§è¡Œçš„è€—æ—¶  
  stime:       ç³»ç»Ÿæ—¶é—´ï¼Œååº”ç³»ç»Ÿè°ƒç”¨æ‰§è¡Œçš„è€—æ—¶
  majorFaultsï¼šéœ€è¦ç¡¬ç›˜æ‹·è´çš„ç¼ºé¡µæ¬¡æ•°
  minorFaultsï¼šæ— éœ€ç¡¬ç›˜æ‹·è´çš„ç¼ºé¡µæ¬¡æ•°
</code></pre><p>å¦‚æœCPUä½¿ç”¨ç‡é•¿æœŸå¤§äº60% ï¼Œè¡¨ç¤ºç³»ç»Ÿå¤„äºç¹å¿™çŠ¶æ€ï¼Œå°±éœ€è¦è¿›ä¸€æ­¥åˆ†æç”¨æˆ·æ—¶é—´å’Œç³»ç»Ÿæ—¶é—´çš„æ¯”ä¾‹ã€‚å¯¹äºæ™®é€šåº”ç”¨ç¨‹åºï¼Œç³»ç»Ÿæ—¶é—´ä¸ä¼šé•¿æœŸé«˜äº30%ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªå€¼ï¼Œæˆ‘ä»¬å°±åº”è¯¥è¿›ä¸€æ­¥æ£€æŸ¥æ˜¯I/Oè¿‡å¤šï¼Œè¿˜æ˜¯å…¶ä»–çš„ç³»ç»Ÿè°ƒç”¨é—®é¢˜ã€‚</p><p>Androidæ˜¯ç«™åœ¨Linuxå·¨äººçš„è‚©è†€ä¸Šï¼Œè™½ç„¶åšäº†ä¸å°‘ä¿®æ”¹ä¹Ÿç æ‰äº†ä¸€äº›å·¥å…·ï¼Œä½†è¿˜æ˜¯ä¿ç•™äº†å¾ˆå¤šæœ‰ç”¨çš„å·¥å…·å¯ä»¥ååŠ©æˆ‘ä»¬æ›´å®¹æ˜“åœ°æ’æŸ¥é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ç»™ä½ ä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œ<strong>topå‘½ä»¤</strong>å¯ä»¥å¸®åŠ©æˆ‘ä»¬æŸ¥çœ‹å“ªä¸ªè¿›ç¨‹æ˜¯CPUçš„æ¶ˆè€—å¤§æˆ·ï¼›<strong>vmstatå‘½ä»¤</strong>å¯ä»¥å®æ—¶åŠ¨æ€ç›‘è§†æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜å’ŒCPUæ´»åŠ¨ï¼›<strong>straceå‘½ä»¤</strong>å¯ä»¥è·Ÿè¸ªæŸä¸ªè¿›ç¨‹ä¸­æ‰€æœ‰çš„ç³»ç»Ÿè°ƒç”¨ã€‚</p><p>é™¤äº†CPUçš„ä½¿ç”¨ç‡ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æŸ¥çœ‹<strong>CPUé¥±å’Œåº¦</strong>ã€‚CPUé¥±å’Œåº¦åæ˜ çš„æ˜¯çº¿ç¨‹æ’é˜Ÿç­‰å¾…CPUçš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯CPUçš„è´Ÿè½½æƒ…å†µã€‚</p><p>CPUé¥±å’Œåº¦é¦–å…ˆä¼šè·Ÿåº”ç”¨çš„çº¿ç¨‹æ•°æœ‰å…³ï¼Œå¦‚æœå¯åŠ¨çš„çº¿ç¨‹è¿‡å¤šï¼Œå®¹æ˜“å¯¼è‡´ç³»ç»Ÿä¸æ–­åœ°åˆ‡æ¢æ‰§è¡Œçš„çº¿ç¨‹ï¼ŒæŠŠå¤§é‡çš„æ—¶é—´æµªè´¹åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæˆ‘ä»¬çŸ¥é“æ¯ä¸€æ¬¡CPUä¸Šä¸‹æ–‡åˆ‡æ¢éƒ½éœ€è¦åˆ·æ–°å¯„å­˜å™¨å’Œè®¡æ•°å™¨ï¼Œè‡³å°‘éœ€è¦å‡ åçº³ç§’çš„æ—¶é—´ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨<code>vmstat</code>å‘½ä»¤æˆ–è€…<code>/proc/[pid]/schedstat</code>æ–‡ä»¶æ¥æŸ¥çœ‹CPUä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œè¿™é‡Œç‰¹åˆ«éœ€è¦æ³¨æ„<code>nr_involuntary_switches</code>è¢«åŠ¨åˆ‡æ¢çš„æ¬¡æ•°ã€‚</p><pre><code>proc/self/sched:
  nr_voluntary_switchesï¼š     
  ä¸»åŠ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œå› ä¸ºçº¿ç¨‹æ— æ³•è·å–æ‰€éœ€èµ„æºå¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæœ€æ™®éçš„æ˜¯IOã€‚    
  nr_involuntary_switchesï¼š   
  è¢«åŠ¨ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°ï¼Œçº¿ç¨‹è¢«ç³»ç»Ÿå¼ºåˆ¶è°ƒåº¦å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œä¾‹å¦‚å¤§é‡çº¿ç¨‹åœ¨æŠ¢å CPUã€‚
  se.statistics.iowait_countï¼šIO ç­‰å¾…çš„æ¬¡æ•°
  se.statistics.iowait_sumï¼š  IO ç­‰å¾…çš„æ—¶é—´
</code></pre><p>æ­¤å¤–ä¹Ÿå¯ä»¥é€šè¿‡uptimeå‘½ä»¤å¯ä»¥æ£€æŸ¥CPUåœ¨1åˆ†é’Ÿã€5åˆ†é’Ÿå’Œ15åˆ†é’Ÿå†…çš„å¹³å‡è´Ÿè½½ã€‚æ¯”å¦‚ä¸€ä¸ª4æ ¸çš„CPUï¼Œå¦‚æœå½“å‰å¹³å‡è´Ÿè½½æ˜¯8ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªCPUä¸Šæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œï¼Œè¿˜æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…ã€‚ä¸€èˆ¬å¹³å‡è´Ÿè½½å»ºè®®æ§åˆ¶åœ¨â€œ0.7 Ã— æ ¸æ•°â€ä»¥å†…ã€‚</p><pre><code>00:02:39 up 7 days, 46 min,  0 users,  
load average: 13.91, 14.70, 14.32
</code></pre><p>å¦å¤–ä¸€ä¸ªä¼šå½±å“CPUé¥±å’Œåº¦çš„æ˜¯çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œçº¿ç¨‹ä¼˜å…ˆçº§ä¼šå½±å“Androidç³»ç»Ÿçš„è°ƒåº¦ç­–ç•¥ï¼Œå®ƒä¸»è¦ç”±niceå’Œcgroupç±»å‹å…±åŒå†³å®šã€‚niceå€¼è¶Šä½ï¼ŒæŠ¢å CPUæ—¶é—´ç‰‡çš„èƒ½åŠ›è¶Šå¼ºã€‚å½“CPUç©ºé—²æ—¶ï¼Œçº¿ç¨‹çš„ä¼˜å…ˆçº§å¯¹æ‰§è¡Œæ•ˆç‡çš„å½±å“å¹¶ä¸ä¼šç‰¹åˆ«æ˜æ˜¾ï¼Œä½†åœ¨CPUç¹å¿™çš„æ—¶å€™ï¼Œçº¿ç¨‹è°ƒåº¦ä¼šå¯¹æ‰§è¡Œæ•ˆç‡æœ‰éå¸¸å¤§çš„å½±å“ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/52/0b/526d72f3dbc70ef45c00e7c0e7bdd80b.png" alt=""></p><p>å…³äºçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œä½ éœ€è¦æ³¨æ„<strong>æ˜¯å¦å­˜åœ¨é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ç©ºç­‰ä½ä¼˜å…ˆçº§çº¿ç¨‹ï¼Œä¾‹å¦‚ä¸»çº¿ç¨‹ç­‰å¾…æŸä¸ªåå°çº¿ç¨‹çš„é”</strong>ã€‚ä»åº”ç”¨ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œæ— è®ºæ˜¯ç”¨æˆ·æ—¶é—´ã€ç³»ç»Ÿæ—¶é—´ï¼Œè¿˜æ˜¯ç­‰å¾…CPUçš„è°ƒåº¦ï¼Œéƒ½æ˜¯ç¨‹åºè¿è¡ŒèŠ±è´¹çš„æ—¶é—´ã€‚</p><h2>Androidå¡é¡¿æ’æŸ¥å·¥å…·</h2><p>å¯èƒ½ä½ ä¼šè§‰å¾—æŒ‰ç…§ä¸Šé¢å„ç§Linuxå‘½ä»¤ç»„åˆæ¥æ’æŸ¥é—®é¢˜å¤ªéº»çƒ¦äº†ï¼Œæœ‰æ²¡æœ‰æ›´ç®€å•çš„ã€å›¾å½¢åŒ–çš„æ“ä½œç•Œé¢å‘¢ï¼ŸTraceviewå’Œsystraceéƒ½æ˜¯æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„æ’æŸ¥å¡é¡¿çš„å·¥å…·ï¼Œä»å®ç°ä¸Šè¿™äº›å·¥å…·åˆ†ä¸ºä¸¤ä¸ªæµæ´¾ã€‚</p><p>ç¬¬ä¸€ä¸ªæµæ´¾æ˜¯instrumentã€‚è·å–ä¸€æ®µæ—¶é—´å†…æ‰€æœ‰å‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼Œå¯ä»¥é€šè¿‡åˆ†æè¿™æ®µæ—¶é—´å†…çš„å‡½æ•°è°ƒç”¨æµç¨‹ï¼Œå†è¿›ä¸€æ­¥åˆ†æå¾…ä¼˜åŒ–çš„ç‚¹ã€‚</p><p>ç¬¬äºŒä¸ªæµæ´¾æ˜¯sampleã€‚æœ‰é€‰æ‹©æ€§æˆ–è€…é‡‡ç”¨æŠ½æ ·çš„æ–¹å¼è§‚å¯ŸæŸäº›å‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼Œå¯ä»¥é€šè¿‡è¿™äº›æœ‰é™çš„ä¿¡æ¯æ¨æµ‹å‡ºæµç¨‹ä¸­çš„å¯ç–‘ç‚¹ï¼Œç„¶åå†ç»§ç»­ç»†åŒ–åˆ†æã€‚</p><p>è¿™ä¸¤ç§æµæ´¾æœ‰ä»€ä¹ˆå·®å¼‚ï¼Ÿæˆ‘ä»¬åœ¨ä»€ä¹ˆåœºæ™¯åº”è¯¥é€‰æ‹©å“ªç§åˆé€‚çš„å·¥å…·å‘¢ï¼Ÿè¿˜æœ‰æ²¡æœ‰å…¶ä»–æœ‰ç”¨çš„å·¥å…·å¯ä»¥ä½¿ç”¨å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬ä¸€ä¸€æ¥çœ‹ã€‚</p><p><strong>1. Traceview</strong></p><p><a href="http://developer.android.com/studio/profile/generate-trace-logs">Traceview</a>æ˜¯æˆ‘ç¬¬ä¸€ä¸ªä½¿ç”¨çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œä¹Ÿæ˜¯åæ§½çš„æ¯”è¾ƒå¤šçš„å·¥å…·ã€‚å®ƒåˆ©ç”¨Android Runtimeå‡½æ•°è°ƒç”¨çš„eventäº‹ä»¶ï¼Œå°†å‡½æ•°è¿è¡Œçš„è€—æ—¶å’Œè°ƒç”¨å…³ç³»å†™å…¥traceæ–‡ä»¶ä¸­ã€‚</p><p>ç”±æ­¤å¯è§ï¼ŒTraceviewå±äºinstrumentç±»å‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥æŸ¥çœ‹æ•´ä¸ªè¿‡ç¨‹æœ‰å“ªäº›å‡½æ•°è°ƒç”¨ï¼Œä½†æ˜¯å·¥å…·æœ¬èº«å¸¦æ¥çš„æ€§èƒ½å¼€é”€è¿‡å¤§ï¼Œæœ‰æ—¶æ— æ³•åæ˜ çœŸå®çš„æƒ…å†µã€‚æ¯”å¦‚ä¸€ä¸ªå‡½æ•°æœ¬èº«çš„è€—æ—¶æ˜¯1ç§’ï¼Œå¼€å¯Traceviewåå¯èƒ½ä¼šå˜æˆ5ç§’ï¼Œè€Œä¸”è¿™äº›å‡½æ•°çš„è€—æ—¶å˜åŒ–å¹¶ä¸æ˜¯æˆæ¯”ä¾‹æ”¾å¤§ã€‚</p><p>åœ¨Android 5.0ä¹‹åï¼Œæ–°å¢äº†<code>startMethodTracingSampling</code>æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨åŸºäºæ ·æœ¬çš„æ–¹å¼è¿›è¡Œåˆ†æï¼Œä»¥å‡å°‘åˆ†æå¯¹è¿è¡Œæ—¶çš„æ€§èƒ½å½±å“ã€‚æ–°å¢äº†sampleç±»å‹åï¼Œå°±éœ€è¦æˆ‘ä»¬åœ¨å¼€é”€å’Œä¿¡æ¯ä¸°å¯Œåº¦ä¹‹é—´åšå¥½æƒè¡¡ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/4b/f5/4b0b688b5248aa2e018f7841b5834cf5.png" alt=""></p><p>æ— è®ºæ˜¯å“ªç§çš„Traceviewå¯¹releaseåŒ…æ”¯æŒçš„éƒ½ä¸å¤ªå¥½ï¼Œä¾‹å¦‚æ— æ³•åæ··æ·†ã€‚å…¶å®traceæ–‡ä»¶çš„æ ¼å¼ååˆ†ç®€å•ï¼Œä¹‹å‰æ›¾ç»å†™ä¸ªä¸€ä¸ªå°å·¥å…·ï¼Œæ”¯æŒé€šè¿‡mappingæ–‡ä»¶åæ··æ·†traceã€‚</p><p><strong>2. Nanoscope</strong></p><p>é‚£åœ¨instrumentç±»å‹çš„æ€§èƒ½åˆ†æå·¥å…·é‡Œï¼Œæœ‰æ²¡æœ‰æ€§èƒ½æŸè€—æ¯”è¾ƒå°çš„å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯æœ‰çš„ï¼ŒUberå¼€æºçš„<a href="http://github.com/uber/nanoscope">Nanoscope</a>å°±èƒ½è¾¾åˆ°è¿™ä¸ªæ•ˆæœã€‚å®ƒçš„å®ç°åŸç†æ˜¯ç›´æ¥ä¿®æ”¹Androidè™šæ‹Ÿæœºæºç ï¼Œåœ¨<code>ArtMethod</code>æ‰§è¡Œå…¥å£å’Œæ‰§è¡Œç»“æŸä½ç½®å¢åŠ åŸ‹ç‚¹ä»£ç ï¼Œå°†æ‰€æœ‰çš„ä¿¡æ¯å…ˆå†™åˆ°å†…å­˜ï¼Œç­‰åˆ°traceç»“æŸåæ‰ç»Ÿä¸€ç”Ÿæˆç»“æœæ–‡ä»¶ã€‚</p><p>åœ¨ä½¿ç”¨è¿‡ç¨‹å¯ä»¥æ˜æ˜¾æ„Ÿè§‰åˆ°åº”ç”¨ä¸ä¼šå› ä¸ºå¼€å¯Nanoscopeè€Œæ„Ÿåˆ°å¡é¡¿ï¼Œä½†æ˜¯traceç»“æŸç”Ÿæˆç»“æœæ–‡ä»¶è¿™ä¸€æ­¥éœ€è¦çš„æ—¶é—´æ¯”è¾ƒé•¿ã€‚<strong>å¦ä¸€æ–¹é¢å®ƒå¯ä»¥æ”¯æŒåˆ†æä»»æ„ä¸€ä¸ªåº”ç”¨ï¼Œå¯ç”¨äºåšç«å“åˆ†æã€‚</strong></p><p>ä½†æ˜¯å®ƒä¹Ÿæœ‰ä¸å°‘é™åˆ¶ï¼š</p><ul>
<li>
<p>éœ€è¦è‡ªå·±åˆ·ROMï¼Œå¹¶ä¸”å½“å‰åªæ”¯æŒNexus 6Pï¼Œæˆ–è€…é‡‡ç”¨å…¶æä¾›çš„x86æ¶æ„çš„æ¨¡æ‹Ÿå™¨ã€‚</p>
</li>
<li>
<p>é»˜è®¤åªæ”¯æŒä¸»çº¿ç¨‹é‡‡é›†ï¼Œå…¶ä»–çº¿ç¨‹éœ€è¦<a href="http://github.com/uber/nanoscope/wiki/Architecture%3A-Nanoscope-ROM#java-api">ä»£ç æ‰‹åŠ¨è®¾ç½®</a>ã€‚è€ƒè™‘åˆ°å†…å­˜å¤§å°çš„é™åˆ¶ï¼Œæ¯ä¸ªçº¿ç¨‹çš„å†…å­˜æ•°ç»„åªèƒ½æ”¯æŒå¤§çº¦20ç§’å·¦å³çš„æ—¶é—´æ®µã€‚</p>
</li>
</ul><p>Uberå†™äº†ä¸€ç³»åˆ—è‡ªåŠ¨åŒ–è„šæœ¬ååŠ©æ•´ä¸ªæµç¨‹ï¼Œä½¿ç”¨èµ·æ¥è¿˜ç®—ç®€å•ã€‚Nanoscopeä½œä¸ºåŸºæœ¬æ²¡æœ‰æ€§èƒ½æŸè€—çš„instrumentå·¥å…·ï¼Œå®ƒéå¸¸é€‚åˆåšå¯åŠ¨è€—æ—¶çš„è‡ªåŠ¨åŒ–åˆ†æã€‚</p><p>Nanoscopeç”Ÿæˆçš„æ˜¯ç¬¦åˆChrome tracingè§„èŒƒçš„HTMLæ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è„šæœ¬æ¥å®ç°ä¸¤ä¸ªåŠŸèƒ½ï¼š</p><p>ç¬¬ä¸€ä¸ªæ˜¯åæ··æ·†ã€‚é€šè¿‡mappingè‡ªåŠ¨åæ··æ·†ç»“æœæ–‡ä»¶ã€‚</p><p>ç¬¬äºŒä¸ªæ˜¯è‡ªåŠ¨åŒ–åˆ†æã€‚ä¼ å…¥ç›¸åŒçš„èµ·ç‚¹å’Œç»ˆç‚¹ï¼Œå®ç°ä¸¤ä¸ªç»“æœæ–‡ä»¶çš„diffï¼Œè‡ªåŠ¨åˆ†æå·®å¼‚ç‚¹ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥æ¯å¤©å®šæœŸå»è·‘è‡ªåŠ¨åŒ–å¯åŠ¨æµ‹è¯•ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ–°å¢çš„è€—æ—¶ç‚¹ã€‚<strong>æˆ‘ä»¬æœ‰æ—¶å€™ä¸ºäº†å®ç°æ›´å¤šå®šåˆ¶åŒ–åŠŸèƒ½æˆ–è€…æ‹¿åˆ°æ›´åŠ ä¸°å¯Œçš„ä¿¡æ¯ï¼Œè¿™ä¸ªæ—¶å€™ä¸å¾—ä¸ä½¿ç”¨å®šåˆ¶ROMçš„æ–¹å¼ã€‚è€ŒNanoscopeæ°æ°æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå¯ä»¥è®©æˆ‘ä»¬æ›´æ–¹ä¾¿åœ°å®ç°å®šåˆ¶ROMï¼Œåœ¨åé¢å¯åŠ¨å’ŒI/Oä¼˜åŒ–é‡Œæˆ‘è¿˜ä¼šæåˆ°æ›´å¤šç±»ä¼¼çš„æ¡ˆä¾‹ã€‚</strong></p><p><strong>3. systrace</strong></p><p><a href="http://source.android.com/devices/tech/debug/systrace?hl=zh-cn">systrace</a>æ˜¯Android 4.1æ–°å¢çš„æ€§èƒ½åˆ†æå·¥å…·ã€‚æˆ‘é€šå¸¸ä½¿ç”¨systraceè·Ÿè¸ªç³»ç»Ÿçš„I/Oæ“ä½œã€CPUè´Ÿè½½ã€Surfaceæ¸²æŸ“ã€GCç­‰äº‹ä»¶ã€‚</p><p>systraceåˆ©ç”¨äº†Linuxçš„<a href="http://source.android.com/devices/tech/debug/ftrace">ftrace</a>è°ƒè¯•å·¥å…·ï¼Œç›¸å½“äºåœ¨ç³»ç»Ÿå„ä¸ªå…³é”®ä½ç½®éƒ½æ·»åŠ äº†ä¸€äº›æ€§èƒ½æ¢é’ˆï¼Œä¹Ÿå°±æ˜¯åœ¨ä»£ç é‡ŒåŠ äº†ä¸€äº›æ€§èƒ½ç›‘æ§çš„åŸ‹ç‚¹ã€‚Androidåœ¨ftraceçš„åŸºç¡€ä¸Šå°è£…äº†<a href="http://android.googlesource.com/platform/frameworks/native/+/master/cmds/atrace/atrace.cpp">atrace</a>ï¼Œå¹¶å¢åŠ äº†æ›´å¤šç‰¹æœ‰çš„æ¢é’ˆï¼Œä¾‹å¦‚Graphicsã€Activity Managerã€Dalvik VMã€System Serverç­‰ã€‚</p><p>systraceå·¥å…·åªèƒ½ç›‘æ§ç‰¹å®šç³»ç»Ÿè°ƒç”¨çš„è€—æ—¶æƒ…å†µï¼Œæ‰€ä»¥å®ƒæ˜¯å±äºsampleç±»å‹ï¼Œè€Œä¸”æ€§èƒ½å¼€é”€éå¸¸ä½ã€‚ä½†æ˜¯å®ƒä¸æ”¯æŒåº”ç”¨ç¨‹åºä»£ç çš„è€—æ—¶åˆ†æï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æ—¶æœ‰ä¸€äº›å±€é™æ€§ã€‚</p><p>ç”±äºç³»ç»Ÿé¢„ç•™äº†<code>Trace.beginSection</code>æ¥å£æ¥ç›‘å¬åº”ç”¨ç¨‹åºçš„è°ƒç”¨è€—æ—¶ï¼Œé‚£æˆ‘ä»¬æœ‰æ²¡æœ‰åŠæ³•åœ¨systraceä¸Šé¢è‡ªåŠ¨å¢åŠ åº”ç”¨ç¨‹åºçš„è€—æ—¶åˆ†æå‘¢ï¼Ÿ</p><p>åˆ’é‡ç‚¹äº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<strong>ç¼–è¯‘æ—¶ç»™æ¯ä¸ªå‡½æ•°æ’æ¡©</strong>çš„æ–¹å¼æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯åœ¨é‡è¦å‡½æ•°çš„å…¥å£å’Œå‡ºå£åˆ†åˆ«å¢åŠ <code>Trace.beginSection</code>å’Œ<code>Trace.endSection</code>ã€‚å½“ç„¶å‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œæˆ‘ä»¬ä¼šè¿‡æ»¤å¤§éƒ¨åˆ†æŒ‡ä»¤æ•°æ¯”è¾ƒå°‘çš„å‡½æ•°ï¼Œè¿™æ ·å°±å®ç°äº†åœ¨systraceåŸºç¡€ä¸Šå¢åŠ åº”ç”¨ç¨‹åºè€—æ—¶çš„ç›‘æ§ã€‚é€šè¿‡è¿™æ ·æ–¹å¼çš„å¥½å¤„æœ‰ï¼š</p><ul>
<li>
<p>å¯ä»¥çœ‹åˆ°æ•´ä¸ªæµç¨‹ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„è°ƒç”¨æµç¨‹ã€‚åŒ…æ‹¬ç³»ç»Ÿå…³é”®çº¿ç¨‹çš„å‡½æ•°è°ƒç”¨ï¼Œä¾‹å¦‚æ¸²æŸ“è€—æ—¶ã€çº¿ç¨‹é”ï¼ŒGCè€—æ—¶ç­‰ã€‚</p>
</li>
<li>
<p>æ€§èƒ½æŸè€—å¯ä»¥æ¥å—ã€‚ç”±äºè¿‡æ»¤äº†å¤§éƒ¨åˆ†çš„çŸ­å‡½æ•°ï¼Œè€Œä¸”æ²¡æœ‰æ”¾å¤§I/Oï¼Œæ‰€ä»¥æ•´ä¸ªè¿è¡Œè€—æ—¶ä¸åˆ°åŸæ¥çš„ä¸¤å€ï¼ŒåŸºæœ¬å¯ä»¥åæ˜ çœŸå®æƒ…å†µã€‚</p>
</li>
</ul><p>systraceç”Ÿæˆçš„ä¹Ÿæ˜¯HTMLæ ¼å¼çš„ç»“æœï¼Œæˆ‘ä»¬åˆ©ç”¨è·ŸNanoscopeç›¸ä¼¼æ–¹å¼å®ç°å¯¹åæ··æ·†çš„æ”¯æŒã€‚</p><p><img src="https://static001.geekbang.org/resource/image/12/15/127526ef09381587f48fb16187b91715.jpg" alt=""></p><p><strong>4. Simpleperf</strong></p><p>é‚£å¦‚æœæˆ‘ä»¬æƒ³åˆ†æNativeå‡½æ•°çš„è°ƒç”¨ï¼Œä¸Šé¢çš„ä¸‰ä¸ªå·¥å…·éƒ½ä¸èƒ½æ»¡è¶³è¿™ä¸ªéœ€æ±‚ã€‚</p><p>Android 5.0æ–°å¢äº†<a href="http://android.googlesource.com/platform/system/extras/+/master/simpleperf/doc/README.md">Simpleperf</a>æ€§èƒ½åˆ†æå·¥å…·ï¼Œå®ƒåˆ©ç”¨CPUçš„æ€§èƒ½ç›‘æ§å•å…ƒï¼ˆPMUï¼‰æä¾›çš„ç¡¬ä»¶perfäº‹ä»¶ã€‚ä½¿ç”¨Simpleperfå¯ä»¥çœ‹åˆ°æ‰€æœ‰çš„Nativeä»£ç çš„è€—æ—¶ï¼Œæœ‰æ—¶å€™ä¸€äº›Androidç³»ç»Ÿåº“çš„è°ƒç”¨å¯¹åˆ†æé—®é¢˜æœ‰æ¯”è¾ƒå¤§çš„å¸®åŠ©ï¼Œä¾‹å¦‚åŠ è½½dexã€verify classçš„è€—æ—¶ç­‰ã€‚</p><p>SimpleperfåŒæ—¶å°è£…äº†systraceçš„ç›‘æ§åŠŸèƒ½ï¼Œé€šè¿‡Androidå‡ ä¸ªç‰ˆæœ¬çš„ä¼˜åŒ–ï¼Œç°åœ¨Simpleperfæ¯”è¾ƒå‹å¥½åœ°æ”¯æŒJavaä»£ç çš„æ€§èƒ½åˆ†æã€‚å…·ä½“æ¥è¯´åˆ†å‡ ä¸ªé˜¶æ®µï¼š</p><p>ç¬¬ä¸€ä¸ªé˜¶æ®µï¼šåœ¨Android Må’Œä»¥å‰ï¼ŒSimpleperfä¸æ”¯æŒJavaä»£ç åˆ†æã€‚</p><p>ç¬¬äºŒä¸ªé˜¶æ®µï¼šåœ¨Android Oå’Œä»¥å‰ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šç¼–è¯‘OATæ–‡ä»¶ã€‚</p><p>ç¬¬ä¸‰ä¸ªé˜¶æ®µï¼šåœ¨Android På’Œä»¥åï¼Œæ— éœ€åšä»»ä½•äº‹æƒ…ï¼ŒSimpleperfå°±å¯ä»¥æ”¯æŒJavaä»£ç åˆ†æã€‚</p><p>ä»è¿™ä¸ªè¿‡ç¨‹å¯ä»¥çœ‹åˆ°Googleè¿˜æ˜¯æ¯”è¾ƒçœ‹é‡è¿™ä¸ªåŠŸèƒ½ï¼Œåœ¨Android Studio 3.2ä¹Ÿåœ¨Profilerä¸­ç›´æ¥æ”¯æŒSimpleperfã€‚</p><p>é¡¾åæ€ä¹‰ï¼Œä»åå­—å°±èƒ½çœ‹å‡ºSimpleperfæ˜¯å±äºsampleç±»å‹ï¼Œå®ƒçš„æ€§èƒ½å¼€é”€éå¸¸ä½ï¼Œä½¿ç”¨ç«ç„°å›¾å±•ç¤ºåˆ†æç»“æœã€‚</p><p><img src="https://static001.geekbang.org/resource/image/de/5f/de8b2064c4fee25166602781fbff915f.jpg" alt=""></p><p>ç›®å‰é™¤äº†Nanoscopeä¹‹å¤–çš„ä¸‰ä¸ªå·¥å…·éƒ½åªæ”¯æŒdebugableçš„åº”ç”¨ç¨‹åºï¼Œå¦‚æœæƒ³æµ‹è¯•releaseåŒ…ï¼Œéœ€è¦å°†æµ‹è¯•æœºå™¨rootã€‚å¯¹äºè¿™ä¸ªé™åˆ¶ï¼Œæˆ‘ä»¬åœ¨å®è·µä¸­ä¼šä¸“é—¨æ‰“å‡ºdebugableçš„æµ‹è¯•åŒ…ï¼Œç„¶åè‡ªå·±å®ç°é’ˆå¯¹mappingçš„åæ··æ·†åŠŸèƒ½ã€‚<strong>å…¶ä¸­Simpleperfçš„åæ··æ·†æ¯”è¾ƒéš¾å®ç°ï¼Œå› ä¸ºåœ¨å‡½æ•°èšåˆåä¼šæŠ›å¼ƒå‚æ•°ï¼Œæ— æ³•ç›´æ¥å¯¹ç”Ÿæˆçš„HTMLæ–‡ä»¶åšå¤„ç†</strong>ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ ¹æ®å„ä¸ªå·¥å…·çš„å®ç°æ€è·¯ï¼Œè‡ªå·±é‡æ–°æ‰“é€ ä¸€å¥—æ”¯æŒédebugableçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·ã€‚</p><p><strong>é€‰æ‹©å“ªç§å·¥å…·ï¼Œéœ€è¦çœ‹å…·ä½“çš„åœºæ™¯ã€‚æˆ‘æ¥æ±‡æ€»ä¸€ä¸‹ï¼Œå¦‚æœéœ€è¦åˆ†æNativeä»£ç çš„è€—æ—¶ï¼Œå¯ä»¥é€‰æ‹©Simpleperfï¼›å¦‚æœæƒ³åˆ†æç³»ç»Ÿè°ƒç”¨ï¼Œå¯ä»¥é€‰æ‹©systraceï¼›å¦‚æœæƒ³åˆ†ææ•´ä¸ªç¨‹åºæ‰§è¡Œæµç¨‹çš„è€—æ—¶ï¼Œå¯ä»¥é€‰æ‹©Traceviewæˆ–è€…æ’æ¡©ç‰ˆæœ¬çš„systraceã€‚</strong></p><h2>å¯è§†åŒ–æ–¹æ³•</h2><p>éšç€Androidç‰ˆæœ¬çš„æ¼”è¿›ï¼ŒGoogleä¸ä»…æä¾›äº†æ›´å¤šçš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œè€Œä¸”ä¹Ÿåœ¨æ…¢æ…¢ä¼˜åŒ–ç°æœ‰å·¥å…·çš„ä½“éªŒï¼Œä½¿åŠŸèƒ½æ›´å¼ºå¤§ã€ä½¿ç”¨é—¨æ§›æ›´ä½ã€‚è€ŒAndroid Studioåˆ™è‚©è´Ÿå¦å¤–ä¸€ä¸ªé‡ä»»ï¼Œé‚£å°±æ˜¯è®©å¼€å‘è€…ä½¿ç”¨èµ·æ¥æ›´åŠ ç®€å•çš„ï¼Œå›¾å½¢ç•Œé¢ä¹Ÿæ›´åŠ ç›´è§‚ã€‚</p><p>åœ¨Android Studio 3.2çš„Profilerä¸­ç›´æ¥é›†æˆäº†å‡ ç§æ€§èƒ½åˆ†æå·¥å…·ï¼Œå…¶ä¸­ï¼š</p><ul>
<li>
<p>Sample Java Methodsçš„åŠŸèƒ½ç±»ä¼¼äºTraceviewçš„sampleç±»å‹ã€‚</p>
</li>
<li>
<p>Trace Java Methodsçš„åŠŸèƒ½ç±»ä¼¼äºTraceviewçš„instrumentç±»å‹ã€‚</p>
</li>
<li>
<p>Trace System Callsçš„åŠŸèƒ½ç±»ä¼¼äºsystraceã€‚</p>
</li>
<li>
<p>SampleNative  (API Level 26+) çš„åŠŸèƒ½ç±»ä¼¼äºSimpleperfã€‚</p>
</li>
</ul><p>å¦ç™½æ¥è¯´ï¼ŒProfilerç•Œé¢åœ¨æŸäº›æ–¹é¢ä¸å¦‚è¿™äº›å·¥å…·è‡ªå¸¦çš„ç•Œé¢ï¼Œæ”¯æŒé…ç½®çš„å‚æ•°ä¹Ÿä¸å¦‚å‘½ä»¤è¡Œï¼Œä¸è¿‡Profilerçš„ç¡®å¤§å¤§é™ä½äº†å¼€å‘è€…çš„ä½¿ç”¨é—¨æ§›ã€‚</p><p>å¦å¤–ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å˜åŒ–æ˜¯åˆ†æç»“æœçš„å±•ç¤ºæ–¹å¼ï¼Œè¿™äº›åˆ†æå·¥å…·éƒ½æ”¯æŒäº†Call Chartå’ŒFlame Chartä¸¤ç§å±•ç¤ºæ–¹å¼ã€‚ä¸‹é¢æˆ‘æ¥è®²è®²è¿™ä¸¤ç§å±•ç¤ºæ–¹å¼é€‚åˆçš„åœºæ™¯ã€‚</p><p><strong>1. Call Chart</strong></p><p>Call Chartæ˜¯Traceviewå’Œsystraceé»˜è®¤ä½¿ç”¨çš„å±•ç¤ºæ–¹å¼ã€‚å®ƒæŒ‰ç…§åº”ç”¨ç¨‹åºçš„å‡½æ•°æ‰§è¡Œé¡ºåºæ¥å±•ç¤ºï¼Œé€‚åˆç”¨äºåˆ†ææ•´ä¸ªæµç¨‹çš„è°ƒç”¨ã€‚ä¸¾ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼ŒAå‡½æ•°è°ƒç”¨Bå‡½æ•°ï¼ŒBå‡½æ•°è°ƒç”¨Cå‡½æ•°ï¼Œå¾ªç¯ä¸‰æ¬¡ï¼Œå°±å¾—åˆ°äº†ä¸‹é¢çš„Call Chartã€‚</p><p><img src="https://static001.geekbang.org/resource/image/db/3e/db3612f661d29efe59854df2e6c2383e.jpg" alt=""></p><p>Call Chartå°±åƒç»™åº”ç”¨ç¨‹åºåšä¸€ä¸ªå¿ƒç”µå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸€æ®µæ—¶é—´å†…ï¼Œå„ä¸ªçº¿ç¨‹çš„å…·ä½“å·¥ä½œï¼Œæ¯”å¦‚æ˜¯å¦å­˜åœ¨çº¿ç¨‹é—´çš„é”ã€ä¸»çº¿ç¨‹æ˜¯å¦å­˜åœ¨é•¿æ—¶é—´çš„I/Oæ“ä½œã€æ˜¯å¦å­˜åœ¨ç©ºé—²ç­‰ã€‚</p><p><strong>2. Flame Chart</strong></p><p>Flame Chartä¹Ÿå°±æ˜¯å¤§åé¼é¼çš„<a href="http://www.brendangregg.com/flamegraphs.html">ç«ç„°å›¾</a>ã€‚å®ƒè·ŸCall Chartä¸åŒçš„æ˜¯ï¼ŒFlame Chartä»¥ä¸€ä¸ªå…¨å±€çš„è§†é‡æ¥çœ‹å¾…ä¸€æ®µæ—¶é—´çš„è°ƒç”¨åˆ†å¸ƒï¼Œå®ƒå°±åƒç»™åº”ç”¨ç¨‹åºæ‹Xå…‰ç‰‡ï¼Œå¯ä»¥å¾ˆè‡ªç„¶åœ°æŠŠæ—¶é—´å’Œç©ºé—´ä¸¤ä¸ªç»´åº¦ä¸Šçš„ä¿¡æ¯èåˆåœ¨ä¸€å¼ å›¾ä¸Šã€‚ä¸Šé¢å‡½æ•°è°ƒç”¨çš„ä¾‹å­ï¼Œæ¢æˆç«ç„°å›¾çš„å±•ç¤ºç»“æœå¦‚ä¸‹ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/6c/01/6ca232173daf9e71f06ac22252d65d01.jpg" alt=""></p><p>å½“æˆ‘ä»¬ä¸æƒ³çŸ¥é“åº”ç”¨ç¨‹åºçš„æ•´ä¸ªè°ƒç”¨æµç¨‹ï¼Œåªæƒ³ç›´è§‚çœ‹å‡ºå“ªäº›ä»£ç è·¯å¾„èŠ±è´¹çš„CPUæ—¶é—´è¾ƒå¤šæ—¶ï¼Œç«ç„°å›¾å°±æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œä¹‹å‰æˆ‘çš„ä¸€ä¸ªååºåˆ—åŒ–å®ç°éå¸¸è€—æ—¶ï¼Œé€šè¿‡ç«ç„°å›¾å‘ç°è€—æ—¶æœ€å¤šçš„æ˜¯å¤§é‡Javaå­—ç¬¦ä¸²çš„åˆ›å»ºå’Œæ‹·è´ï¼Œé€šè¿‡å°†æ ¸å¿ƒå®ç°è½¬ä¸ºNativeï¼Œæœ€ç»ˆä½¿æ€§èƒ½æå‡äº†å¾ˆå¤šå€ã€‚</p><p>ç«ç„°å›¾è¿˜å¯ä»¥ä½¿ç”¨åœ¨å„ç§å„æ ·çš„ç»´åº¦ï¼Œä¾‹å¦‚å†…å­˜ã€I/Oçš„åˆ†æã€‚æœ‰äº›å†…å­˜å¯èƒ½éå¸¸ç¼“æ…¢åœ°æ³„æ¼ï¼Œé€šè¿‡ä¸€ä¸ªå†…å­˜çš„ç«ç„°å›¾ï¼Œæˆ‘ä»¬å°±çŸ¥é“å“ªäº›è·¯å¾„ç”³è¯·çš„å†…å­˜æœ€å¤šï¼Œæœ‰äº†ç«ç„°å›¾æˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦åˆ†ææºä»£ç ï¼Œä¹Ÿä¸éœ€è¦åˆ†ææ•´ä¸ªæµç¨‹ã€‚</p><p>æœ€åæˆ‘æƒ³è¯´ï¼Œæ¯ä¸ªå·¥å…·éƒ½å¯ä»¥ç”Ÿæˆä¸åŒçš„å±•ç¤ºæ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹å¼ã€‚</p><h2>æ€»ç»“</h2><p>åœ¨å†™ä»Šå¤©çš„æ–‡ç« ï¼Œä¹Ÿå°±æ˜¯åˆ†æå¡é¡¿çš„åŸºç¡€çŸ¥è¯†å’Œå››ç§Androidå¡é¡¿æ’æŸ¥å·¥å…·æ—¶ï¼Œæˆ‘è¶Šå‘è§‰å¾—åº•å±‚åŸºç¡€çŸ¥è¯†çš„é‡è¦æ€§ã€‚Androidåº•å±‚åŸºäºLinuxå†…æ ¸ï¼Œåƒsystraceã€Simpleperfä¹Ÿæ˜¯åˆ©ç”¨Linuxæä¾›çš„æœºåˆ¶å®ç°ï¼Œå› æ­¤å­¦ä¹ ä¸€äº›Linuxçš„åŸºç¡€çŸ¥è¯†ï¼Œå¯¹äºç†è§£è¿™äº›å·¥å…·çš„å·¥ä½œåŸç†ä»¥åŠæ’æŸ¥æ€§èƒ½é—®é¢˜ï¼Œéƒ½æœ‰å¾ˆå¤§å¸®åŠ©ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼Œè™½ç„¶å¾ˆå¤šå¤§å‚æœ‰ä¸“é—¨çš„æ€§èƒ½ä¼˜åŒ–å›¢é˜Ÿï¼Œä½†æˆ‘è§‰å¾—é¼“åŠ±å’ŒåŸ¹å…»å›¢é˜Ÿé‡Œçš„æ¯ä¸€ä¸ªäººéƒ½å»å…³æ³¨æ€§èƒ½é—®é¢˜æ›´åŠ é‡è¦ã€‚æˆ‘ä»¬åœ¨ä½¿ç”¨æ€§èƒ½å·¥å…·çš„åŒæ—¶ï¼Œè¦å­¦ä¼šæ€è€ƒï¼Œåº”è¯¥çŸ¥é“å®ƒä»¬çš„åŸç†å’Œå±€é™æ€§ã€‚æ›´è¿›ä¸€æ­¥æ¥è¯´ï¼Œä½ è¿˜å¯ä»¥å°è¯•å»ä¸ºè¿™äº›å·¥å…·åšä¸€äº›ä¼˜åŒ–ï¼Œä»è€Œå®ç°æ›´åŠ å®Œå–„çš„æ–¹æ¡ˆã€‚</p><h2>è¯¾åä½œä¸š</h2><p>å½“å‘ç”ŸANRçš„æ—¶å€™ï¼ŒAndroidç³»ç»Ÿä¼šæ‰“å°CPUç›¸å…³çš„ä¿¡æ¯åˆ°æ—¥å¿—ä¸­ï¼Œä½¿ç”¨çš„æ˜¯<a href="http://androidxref.com/9.0.0_r3/xref/frameworks/base/core/java/com/android/internal/os/ProcessCpuTracker.java">ProcessCpuTracker.java</a>ã€‚ä½†æ˜¯è¿™æ ·å¥½åƒå¹¶æ²¡æœ‰æƒé™å¯ä»¥æ‹¿åˆ°å…¶ä»–åº”ç”¨è¿›ç¨‹çš„CPUä¿¡æ¯ï¼Œé‚£èƒ½ä¸èƒ½æ¢ä¸€ä¸ªæ€è·¯ï¼Ÿ</p><p>å½“å‘ç°åº”ç”¨çš„æŸä¸ªè¿›ç¨‹CPUä½¿ç”¨ç‡æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‡ ä¸ªæ–‡ä»¶æ£€æŸ¥è¯¥è¿›ç¨‹ä¸‹å„ä¸ªçº¿ç¨‹çš„CPUä½¿ç”¨ç‡ï¼Œç»§è€Œç»Ÿè®¡å‡ºè¯¥è¿›ç¨‹å„ä¸ªçº¿ç¨‹çš„æ—¶é—´å æ¯”ã€‚</p><pre><code>/proc/[pid]/stat             // è¿›ç¨‹CPUä½¿ç”¨æƒ…å†µ
/proc/[pid]/task/[tid]/stat  // è¿›ç¨‹ä¸‹é¢å„ä¸ªçº¿ç¨‹çš„CPUä½¿ç”¨æƒ…å†µ
/proc/[pid]/sched            // è¿›ç¨‹CPUè°ƒåº¦ç›¸å…³
/proc/loadavg                // ç³»ç»Ÿå¹³å‡è´Ÿè½½ï¼Œuptimeå‘½ä»¤å¯¹åº”æ–‡ä»¶
</code></pre><p>å¦‚æœçº¿ç¨‹é”€æ¯äº†ï¼Œå®ƒçš„CPUè¿è¡Œä¿¡æ¯ä¹Ÿä¼šè¢«åˆ é™¤ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬åªä¼šè®¡ç®—æŸä¸€æ®µæ—¶é—´å†…CPUä½¿ç”¨ç‡ã€‚ä¸‹é¢æ˜¯è®¡ç®—5ç§’é—´éš”å†…ä¸€ä¸ªSampleè¿›ç¨‹çš„CPUä½¿ç”¨ç¤ºä¾‹ã€‚<strong>æœ‰çš„æ—¶å€™å¯èƒ½æ‰¾ä¸åˆ°è€—æ—¶çš„çº¿ç¨‹ï¼Œæœ‰å¯èƒ½æ˜¯æœ‰å¤§é‡ç”Ÿå‘½å‘¨æœŸå¾ˆçŸ­çš„çº¿ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥æŠŠæ—¶é—´é—´éš”ç¼©çŸ­æ¥çœ‹çœ‹ã€‚</strong></p><pre><code>usage: CPU usage 5000ms(from 23:23:33.000 to 23:23:38.000):
System TOTAL: 2.1% user + 16% kernel + 9.2% iowait + 0.2% irq + 0.1% softirq + 72% idle
CPU Core: 8
Load Average: 8.74 / 7.74 / 7.36

Process:com.sample.appÂ 
  50% 23468/com.sample.app(S): 11% user + 38% kernel faults:4965

Threads:
Â  43% 23493/singleThread(R): 6.5% user + 36% kernel faultsï¼š3094
Â  3.2% 23485/RenderThread(S): 2.1% user + 1% kernel faultsï¼š329
Â  0.3% 23468/.sample.app(S): 0.3% user + 0% kernel faultsï¼š6
Â  0.3% 23479/HeapTaskDaemon(S): 0.3% user + 0% kernel faultsï¼š982
  ...
</code></pre><p><span class="orange">ä»Šå¤©çš„è¯¾åä½œä¸šæ˜¯ï¼Œè¯·ä½ åœ¨ç•™è¨€åŒºè§£è¯»ä¸€ä¸‹ä¸Šé¢çš„ä¿¡æ¯ï¼Œåˆ†äº«ä¸€ä¸‹ä½ è®¤ä¸ºè¿™ä¸ªç¤ºä¾‹çš„ç“¶é¢ˆåœ¨ä»€ä¹ˆåœ°æ–¹ã€‚</span>ä¹‹åèƒ½ä¸èƒ½æ›´è¿›ä¸€æ­¥ï¼Œè‡ªå·±åŠ¨æ‰‹å†™ä¸€ä¸ªå·¥å…·ï¼Œå¾—åˆ°ä¸€æ®µæ—¶é—´å†…ä¸Šé¢çš„è¿™äº›ç»Ÿè®¡ä¿¡æ¯ã€‚åŒæ ·æœ€ç»ˆçš„å®ç°å¯ä»¥é€šè¿‡å‘<a href="http://github.com/AndroidAdvanceWithGeektime/Chapter05">Sample</a>å‘é€Pull Requestã€‚</p><p>æ¬¢è¿ä½ ç‚¹å‡»â€œè¯·æœ‹å‹è¯»â€ï¼ŒæŠŠä»Šå¤©çš„å†…å®¹åˆ†äº«ç»™å¥½å‹ï¼Œé‚€è¯·ä»–ä¸€èµ·å­¦ä¹ ã€‚æœ€ååˆ«å¿˜äº†åœ¨è¯„è®ºåŒºæäº¤ä»Šå¤©çš„ä½œä¸šï¼Œæˆ‘ä¹Ÿä¸ºè®¤çœŸå®Œæˆä½œä¸šçš„åŒå­¦å‡†å¤‡äº†ä¸°åšçš„â€œå­¦ä¹ åŠ æ²¹ç¤¼åŒ…â€ï¼ŒæœŸå¾…ä¸ä½ ä¸€èµ·åˆ‡ç£‹è¿›æ­¥å“¦ã€‚</p><p><img src="https://static001.geekbang.org/resource/image/24/c0/24c190870d71c3daa203a939d67358c0.jpg" alt=""><img src="https://static001.geekbang.org/resource/image/30/aa/306ef8892cc985a19fdd36534e7c5daa.png" alt=""></p>
                    </div>
                </div>

            </div>
            <div data-v-87ffcada="" class="article-comments pd"><h2 data-v-87ffcada=""><span
                    data-v-87ffcada="">ç²¾é€‰ç•™è¨€</span></h2>
                <ul data-v-87ffcada="">
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/1b/e6/6a88c8a3.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åˆ˜ä¼Ÿ</span>
                            </div>
                            <div class="bd">é«˜çº§çš„ä¸œè¥¿çœ‹çš„è¶Šå¤šï¼Œè¶Šè§‰å¾—Androidé«˜æ·±çš„ä¸œè¥¿éƒ½æ˜¯åœ¨Andriodä¹‹å¤–çš„~ <br></div>
                            <span class="time">2018-12-13 22:36</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/4b/b6/b7c79ed7.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å°é›¨ç‚¹</span>
                            </div>
                            <div class="bd">æœ‰ç‚¹æ·±äº†ï¼Œè¡¨ç¤ºçœ‹ä¸å¤ªæ‡‚ <br></div>
                            <span class="time">2018-12-11 18:02</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ˜¯linuxéƒ¨åˆ†è¿˜æ˜¯å››ä¸ªå¡é¡¿å·¥å…·æ¯”è¾ƒéš¾å‘¢ï¼Ÿ<br></p>
                                <p class="reply-time">2018-12-11 19:51</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/76/ae/d6f40a9b.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¿—ä¼Ÿ</span>
                            </div>
                            <div class="bd">8æ ¸cpuï¼Œå¹³å‡è´Ÿè½½8ï¼Œidleæ—¶é—´å»åˆ°72%ï¼Œè¯´æ˜åº”ç”¨è¿è¡Œä¸­ç³»ç»ŸCPUæ€§èƒ½æœ‰å¾ˆå¤§çš„ç›ˆä½™ã€‚<br>sampleåº”ç”¨æ—¶é—´åˆ†å¸ƒå¤§å¤´åœ¨kernelï¼Œç»†åˆ†çœ‹çº¿ç¨‹ï¼ŒSingleThreadæ˜¯ä¸»è¦è€—æ—¶çº¿ç¨‹ï¼Œå¹¶ä¸”å…±å‘ç”Ÿäº†3094æ¬¡ç¼ºé¡µå¼‚å¸¸(faultså­—æ®µ)ã€‚ç¼ºé¡µå¼‚å¸¸çš„å¤„ç†æ˜¯åœ¨å†…æ ¸ç©ºé—´ï¼Œä¹Ÿè§£é‡Šäº†kernel è€—æ—¶å¤§å¤´çš„åŸå› ï¼Œè€Œè¿™é‡Œåšçš„æ“ä½œå°±æ˜¯è¯»å†™ç£ç›˜ã€‚çŒœæµ‹å¯èƒ½æ˜¯å¾ˆå¤šå°æ–‡ä»¶çš„è¯»å†™ã€‚<br>ç»¼åˆåˆ†æç“¶é¢ˆåº”è¯¥æ˜¯sampleå°†ioé›†ä¸­åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­å¤„ç†ï¼Œç³»ç»Ÿçš„å…¨éƒ¨cpuæ²¡æœ‰åˆ©ç”¨ä¸Šï¼Œä¸€æ ¸å¿™æ­»ï¼Œå…¶ä»–3æ ¸é—²æ­»ã€‚ <br></div>
                            <span class="time">2018-12-11 21:31</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/a4/6f/672a27d4.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">will</span>
                            </div>
                            <div class="bd">å¾ˆå¤šæ²¡æœ‰æ¥è§¦çš„å·¥å…·ï¼Œè¿˜æ˜¯éœ€è¦å»äº†è§£ä¸€ä¸‹Linuxæ–¹é¢çš„åŸºç¡€ï¼Œåé¢çš„ä½œä¸šæ²¡çœ‹å¤ªæ˜ç™½ <br></div>
                            <span class="time">2018-12-11 22:22</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/5b/dd/26056401.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">memory</span>
                            </div>
                            <div class="bd">æ„Ÿè§‰è¿™ä¸ªè¯¾å¯èƒ½æ›´é€‚ç”¨äºæ¯”è¾ƒæ·±å…¥ç ”ç©¶è¿‡å†…å­˜æ–¹é¢çŸ¥è¯†çš„äººï¼Œä½†æ˜¯å¤§éƒ¨åˆ†äººåº”è¯¥éƒ½æ˜¯å¼€å‘ä¸šåŠ¡çš„ç¨‹åºå‘˜ï¼Œæƒ³å¯¹è¿™æ–¹é¢åšä¸ªç³»ç»Ÿçš„å­¦ä¹ ï¼Œæ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹éš¾äº†ï¼Œç»™å‡ºçš„è¯¾åä½œä¸šï¼Œæœ‰ç‚¹ä¸€è„¸æ‡µé€¼ï¼Œæœ‰ç‚¹æ— ä»ä¸‹æ‰‹çš„æ„Ÿè§‰ <br></div>
                            <span class="time">2018-12-12 11:49</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å·²ç»å¾ˆå°‘å¾ˆç®€å•ä½†æ˜¯åˆå¯ä»¥è¿›é˜¶çš„å†…å®¹ï¼Œå¯ä»¥å°è¯•çœ‹çœ‹æ–‡ç« ä¸­çš„ä¸€äº›èƒŒæ™¯çŸ¥è¯†<br><br>åç»­ä¹Ÿä¼šç»™å‡ºå­¦ä¹ è·¯çº¿å›¾å‡ºæ¥</p>
                                <p class="reply-time">2018-12-12 13:00</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/13/45/91/1233679c.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Dr.strangeğŸ¬</span>
                            </div>
                            <div class="bd">å¤§ç¥ï¼Œèƒ½ç»™Linuxçš„å­¦ä¹ è·¯çº¿å— <br></div>
                            <span class="time">2018-12-13 15:58</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/47/27/448b5262.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æˆ‘çš„å¿ƒæƒ…åœ¨è¡æ¼¾</span>
                            </div>
                            <div class="bd">å„ç§å‘½ä»¤ä¸€è„¸æ‡µé€¼ <br></div>
                            <span class="time">2018-12-12 21:15</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™äº›éƒ½æ˜¯æ¯”è¾ƒåŸºæœ¬linuxå‘½ä»¤ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥ä¸€ä¸‹ç”¨æ³•</p>
                                <p class="reply-time">2018-12-12 23:04</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/12/e6/5d/b72d2464.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">snzang</span>
                            </div>
                            <div class="bd">æ­ªä¸ªæ¥¼ï¼Œæƒ³è¯·æ•™å¤§ç¥ä»¬ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘å¸çš„é¡¹ç›®æ‰“debugç­¾åçš„åŒ…è·‘åœ¨Android8.0ä»¥ä¸Šçš„æœºå™¨æ—¶ä¼šéå¸¸å¡ï¼Œæ¢æˆreleaseç­¾åå°±å¾ˆæµç•…ã€‚åœ¨8.0ä»¥ä¸‹çš„æ‰‹æœºä¸Šè¿è¡Œreleaseå’Œdebugçš„åŒ…éƒ½å¾ˆæµç•…ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯8.0é™åˆ¶äº†debugåŒ…çš„è¿è¡Œå†…å­˜ï¼Œæƒ³åœ¨è¿™é‡Œé—®ä¸‹æœ‰é‡åˆ°ç›¸åŒæƒ…å†µçš„åŒå­¦å—ï¼Ÿ <br></div>
                            <span class="time">2018-12-11 21:32</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/0f/ef/e5/7b871b6d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Geek_JsonHu</span>
                            </div>
                            <div class="bd">å¸Œæœ›ä½œè€…èƒ½ç»™å‡ºä¸ªæ·±å…¥å­¦ä¹ çš„è·¯çº¿å›¾ <br></div>
                            <span class="time">2018-12-20 10:37</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">æ­£åœ¨æ•´ç†ä¸­</p>
                                <p class="reply-time">2018-12-21 13:05</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/a3/1f/c94facb8.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">nodlee</span>
                            </div>
                            <div class="bd">ç†è®ºæ˜¯åŸºçŸ³ï¼Œä¾‹å­æ˜¯ä¸Šå±‚å»ºç­‘ã€‚å¸Œæœ›ä½œè€…å¤šç»“åˆä¸€äº›å®é™…æ¡ˆä¾‹è®²è§£ï¼Œç†è®ºå¤ªå¤šï¼Œæ„Ÿè§‰å¾ˆç©ºæ´ã€‚ä½œä¸ºä»˜è´¹ç”¨æˆ·ï¼Œè¿™ä¸ªè¦æ±‚ä¸é«˜å§ã€‚ <br></div>
                            <span class="time">2018-12-14 16:17</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/50/e0/e0b368c1.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">æå¤§å¯</span>
                            </div>
                            <div class="bd">é€šè¿‡è¯»å–æ–‡ä»¶è·å–è¿›ç¨‹cpu,çº¿ç¨‹cpuç­‰ä½¿ç”¨çŠ¶æ€çš„ä¸€ä¸ªé—®é¢˜æ˜¯åœ¨ä¸å°‘æœºå‹ä¸Šï¼Œæ²¡æœ‰è¯»å–è¿™äº›æ–‡ä»¶çš„æƒé™ã€‚å¦‚æœéœ€è¦å°†releaseç‰ˆæœ¬çš„è¿™äº›æ€§èƒ½æ•°æ®é‡‡é›†å¹¶ä¸Šä¼ ä¾›æ•°æ®åˆ†æï¼Œæ•°æ®çš„é‡‡é›†å°±æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚çº¿ç¨‹cpuä½¿ç”¨ç‡ï¼Œå¸¸è§„çš„åšæ³•æ˜¯æ‰ç”¨ä¸¤ä¸ªé—´éš”æ—¶é—´è¾ƒçŸ­çš„cpuå¿«ç…§ï¼Œç„¶åè®¡ç®—åº”ç”¨cpuä½¿ç”¨æ—¶é—´åœ¨ç³»ç»Ÿcpuä½¿ç”¨æ—¶é—´æ‰€å çš„æ¯”ä¾‹ï¼Œä½†æ˜¯cpuä½¿ç”¨æ—¶é—´æ˜¯ä¸€ä¸ªä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œä¸Šè¿°çš„ç»Ÿè®¡æ–¹æ³•å¹¶ä¸å¤Ÿå‡†ç¡® <br></div>
                            <span class="time">2018-12-13 09:22</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">ä»æˆ‘ä»¬çš„åº”ç”¨æ¥çœ‹ï¼Œè·å¾—çš„æˆåŠŸç‡è¿˜æ˜¯éå¸¸é«˜çš„ã€‚<br><br>å› ä¸ºæˆ‘ä»¬åº”ç”¨åŸºæœ¬åšäº†çº¿ç¨‹æ± æ”¶æ‹¢ï¼Œå¤§éƒ¨åˆ†çº¿ç¨‹éƒ½æ˜¯å¸¸é©»çš„ã€‚å¯ä»¥ä»æ•´ä½“ä¸Šçœ‹åˆ°å„ä¸ªçº¿ç¨‹çš„ä¸€äº›æƒ…å†µï¼Œè¿™å—æ•°æ®åœ¨ä¸€äº›åœºæ™¯ä½œç”¨ä¸å¤§ï¼Œä¸€äº›åœºæ™¯è¿˜æ˜¯å¯ä»¥å‘ç°é—®é¢˜ã€‚</p>
                                <p class="reply-time">2018-12-13 10:42</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/4a/18/90810a3d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">çŸ³å…ˆ</span>
                            </div>
                            <div class="bd">ç»æ–‡å“¥ï¼Œæˆ‘åˆæ¥äº†ã€‚æˆ‘æ¯”è¾ƒæ„Ÿå…´è¶£ä¹‹å‰å†…å­˜ä¼˜åŒ–æ–‡ç« é‡Œé¢æåˆ°å¯¹ Bitmap çš„ä¼˜åŒ–ï¼Œå¯ä»¥[é€šè¿‡ç›´æ¥è°ƒç”¨ libandroid_runtime.so ä¸­ Bitmap çš„æ„é€ å‡½æ•°]æ¥åˆ›å»ºä¸€ä¸ªç©ºçš„ nativeBitmap å¯¹è±¡ï¼Œä½†è¿™ä¸ªæ“ä½œè·Ÿå¹³æ—¶è‡ªå·±é€šè¿‡ jni è°ƒç”¨è‡ªå·±ç¼–è¯‘çš„ so åŒ…é‡Œçš„ native æ–¹æ³•ä¸å¤ªä¸€æ ·ï¼Œç½‘ä¸Šä¹Ÿæ‰¾ä¸åˆ°ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªè¿‡ç¨‹ï¼Œæ‰€ä»¥èƒ½ä¸èƒ½æŠŠè¿™ä¸ªè¿‡ç¨‹å†æè¿°è¯¦ç»†ä¸€ç‚¹ï¼Œæˆ–è€…æœ€å¥½æ˜¯èƒ½ show me codeï¼Œæˆ‘ä¹Ÿæƒ³è‡ªå·±å®æ“ä¸€éä½ è¯´çš„é‚£äº›ç‚¹ï¼Œéå¸¸æ„Ÿè°¢ã€‚ <br></div>
                            <span class="time">2018-12-12 18:03</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">è¿™ä¸ªå…¶å®æ²¡é‚£ä¹ˆç®€å•ï¼Œç¼–è¯‘çš„æ—¶å€™ä¹Ÿè¦æŠŠBitmapç›¸å…³çš„å¾ˆå¤šå¤´æ–‡ä»¶å¼•å…¥ã€‚<br><br>è°ƒç”¨æ˜¯é€šè¿‡dlsymæ¥å®ç°çš„ï¼Œè¿™å—æˆ‘åç»­æœ‰æ—¶é—´æäº¤åˆ°githubå§</p>
                                <p class="reply-time">2018-12-12 19:03</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/58/e2/11ccd4d0.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åºå·æœˆ</span>
                            </div>
                            <div class="bd">è™½ç„¶å¥½å¤šä¸œè¥¿ä¸æ‡‚æˆ–è€…æ²¡å¬è¿‡ï¼Œä½†æ˜¯è¿™ä¹ˆç³»ç»Ÿçš„äº†è§£ä¸‹è¿˜æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œç­‰ä»¥åæ…¢æ…¢ä¼šçœ‹æ¶ˆåŒ–ã€‚ä½œä¸ºä¸€ä¸ªå½“æªåŒ¹é©¬å¹²äº†5å¹´çš„å¼€å‘æ¥è¯´ï¼Œäº‰å–ä»¥åæ…¢æ…¢æŠŠè¿™äº›ä¸€ç‚¹ç‚¹åº”ç”¨åˆ°å¼€å‘ä¸­ï¼Œå»ºè®®ç»æ–‡å¤§ç¥å¯ä»¥åœ¨ä»¥åçš„è¯¾ç¨‹ä¸­è®²è§£ä¸­ç»“åˆå•å¹²è€…çš„å¼€å‘åœºæ™¯åšä¸€äº›åˆ†äº«ï¼Œæ„Ÿè°¢å¤§ä½¬åˆ†äº«ï¼Œä¹Ÿå¸Œæœ›å•å¹²ç€ä¸€èµ·äº¤æµã€‚ <br></div>
                            <span class="time">2018-12-12 15:34</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/46/d4/d195e55d.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">ä¸¤å¤©</span>
                            </div>
                            <div class="bd">è¡¨ç¤ºå¾ˆæœ‰ç”¨ï¼Œæ»¡æ»¡çš„å¹²è´§ <br></div>
                            <span class="time">2018-12-11 23:13</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/83/ef/445e1421.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">yongxiang</span>
                            </div>
                            <div class="bd">ç»æ–‡è€å¸ˆï¼Œä» Android O å¼€å§‹ä¸å…è®¸éç³»ç»Ÿ app è¯»å– &#47;proc&#47;stat æ–‡ä»¶äº†ï¼Œæ— æ³•è¯»å–ç³»ç»Ÿ cpu çš„ ä½¿ç”¨æƒ…å†µã€‚ä¸çŸ¥æ˜¯å¦è¿˜æœ‰æ–°çš„åœ¨çº¿ç›‘æ§ cpu ä½¿ç”¨ç‡çš„æ–¹æ³•ï¼Ÿç½‘ä¸Šæ‰¾äº†å¥½ä¹…å¥½ä¹…ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°æ–°çš„æ–¹æ³•ã€‚è°¢è°¢https:&#47;&#47;issuetracker.google.com&#47;issues&#47;37140047 <br></div>
                            <span class="time">2019-01-11 11:33</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">Xmilton</span>
                            </div>
                            <div class="bd">å¼ æ€»ï¼Œæˆ‘æƒ³é—®ä¸‹çœŸæœºæ˜¯ä¸æ˜¯è¯»ä¸åˆ°&#47;proc&#47;staté‡Œçš„ä¿¡æ¯ï¼Ÿè¯¥æ€ä¹ˆå¤„ç†å‘¢ã€‚ <br></div>
                            <span class="time">2019-01-09 17:18</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/14/55/a1/5cf57038.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">______å¿ƒå²›å·²æ™´ã€‚</span>
                            </div>
                            <div class="bd">å¥½å¤šå…³äºlinuxçš„åªæ˜¯ï¼Œç°åœ¨éœ€è¦å»æ•´ç†ä¸€ä¸‹ï¼Œæœ‰ç‚¹å¥½æ·±å¥¥ <br></div>
                            <span class="time">2018-12-20 08:26</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epZHmvJIosQ5OrAnIwCE7BY8D5XxJxtVa1rrkHTKImUzianyXfibtiapZauWgUpmXbyJu4X3QxMlnCNw/132" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å¼ æ•¬ä¸œ</span>
                            </div>
                            <div class="bd">appè¿è¡Œæ˜¯å†…å­˜åŸºæœ¬åœ¨500Må·¦å³ç®—ä¸ç®—æ˜¯å¾ˆé«˜çš„å†…å­˜è¡¨ç°äº†? çœ‹äº†ä¸‹ä¸»è¦æ˜¯nativeå†…å­˜å¯ä»¥åˆ°190Må·¦å³ï¼Œå¹³æ—¶nativeå†…å­˜ä¹Ÿæ˜¯æœ€ä½åœ¨120Må·¦å³ã€‚ <br></div>
                            <span class="time">2018-12-19 17:56</span>
                            
                            <div class="reply">
                                <div class="reply-hd"><span>ä½œè€…å›å¤</span></div>
                                <p class="reply-content">å¯ä»¥æ ¹æ®å†…å­˜ä¼˜åŒ–çš„æ€è·¯æ¥çœ‹ä¸€ä¸‹</p>
                                <p class="reply-time">2018-12-20 09:35</p>
                            </div>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/10/07/8c/51401220.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">å°ç¾</span>
                            </div>
                            <div class="bd">ç»æ–‡è€å¸ˆï¼š æˆ‘åœ¨æˆ‘è™šæ‹Ÿæœºä¸ŠæŸ¥çœ‹cpu é¢‘ç‡ï¼Œå¯æ˜¯æ‚¨æ–‡ä¸­è¯´çš„é‚£ä¸ªæ–‡ä»¶æ²¡æœ‰<br>root@vbox86p:&#47;sys&#47;devices&#47;system&#47;cpu&#47;cpu0 # cd cpufreq<br>&#47;system&#47;bin&#47;sh: cd: &#47;sys&#47;devices&#47;system&#47;cpu&#47;cpu0&#47;cpufreq: No such file or directory<br>è¿™å’Œandroid ç³»ç»Ÿæœºå™¨ç›¸å…³å—ï¼Ÿ<br> <br></div>
                            <span class="time">2018-12-18 12:02</span>
                            
                        </div>
                    </li>
                    
                    <li data-v-87ffcada="" class="comment-item"><img
                            src="https://static001.geekbang.org/account/avatar/00/11/8e/c7/6d08d502.jpg" class="avatar">
                        <div class="info">
                            <div class="hd"><span class="username">åŒå­åº§çš„é©¬å…‹æ€</span>
                            </div>
                            <div class="bd">[è¡¥å……è¯„è®ºåŒºç•™è¨€]singleThreadçº¿ç¨‹kernelå¤±è¯¯ç‡3094å 36%ï¼ŒSystem TOTALä¸­iowaitå 9.2%ï¼Œioç­‰å¾…æ—¶é—´è¿‡é•¿ï¼Œåº”è¯¥æ˜¯æ–‡ä»¶æ“ä½œä¸å½“å¯¼è‡´å†…æ ¸å¤±è¯¯ç‡è¿‡é«˜ï¼Œå¯èƒ½æƒ…å†µï¼šä¸€ã€æ–‡ä»¶å†…å®¹è¯»å†™æ“ä½œä¸å½“ï¼›äºŒã€æ–‡ä»¶è¿‡å¤šã€‚5ç§’æ—¶é—´é—´éš”ä¸‹ï¼Œç¬¬ä¸€ç§æƒ…å†µæ›´å¯èƒ½ä¸€äº›ã€‚ <br></div>
                            <span class="time">2018-12-18 11:34</span>
                            
                        </div>
                    </li>
                    


                </ul>
            </div>
        </div>
    </div>
</div>
</body>
</html>